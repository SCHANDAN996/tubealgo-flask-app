(()=>{function l(){return{isLoading:!1,loadingMessage:"",step:1,topic:PAGE_DATA.initialTopic||"",csrfToken:"",generatedTitles:[],selectedTitle:null,generatedContent:{description:"",outline:"",tags:{}},activeTab:"description",init(){let e=document.querySelector('input[name="csrf_token"]');e&&(this.csrfToken=e.value)},async generateTitles(){if(!this.topic.trim()){alert("Please enter a topic for your video.");return}this.isLoading=!0,this.loadingMessage="Generating Titles & Tags...";try{let e=await fetch(PAGE_DATA.urls.generateTitles,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({topic:this.topic})}),t=await e.json();if(!e.ok)throw new Error(t.error||"Failed to generate titles.");this.generatedTitles=t.titles||[],this.generatedContent.tags=t.tags||{},this.selectedTitle=null,this.step=2}catch(e){alert("Error: "+e.message)}finally{this.isLoading=!1}},async generateFinalContent(){if(!this.selectedTitle){alert("Please select a title before proceeding.");return}this.isLoading=!0,this.loadingMessage="Generating final content...",this.activeTab="description";try{let e=fetch(PAGE_DATA.urls.generateDescription,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({topic:this.topic,title:this.selectedTitle})}).then(a=>a.json()),t=fetch(PAGE_DATA.urls.generateScript,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({topic:this.topic,title:this.selectedTitle})}).then(a=>a.json()),[i,s]=await Promise.all([e,t]);if(i.error||s.error)throw new Error(i.error||s.error||"Failed to generate content.");this.generatedContent.description=i.description||"Could not generate description.",this.generatedContent.outline=s.outline||"Could not generate script outline.",this.step=3}catch(e){alert("Error: "+e.message)}finally{this.isLoading=!1}},copyToClipboard(e,t){e&&navigator.clipboard.writeText(e).then(()=>{let i=t.textContent;t.textContent="Copied!",setTimeout(()=>{t.textContent=i},2e3)})},copyAllTags(e){if(!this.generatedContent||!this.generatedContent.tags)return;let t=[...this.generatedContent.tags.main_keywords||[],...this.generatedContent.tags.secondary_keywords||[],...this.generatedContent.tags.broad_tags||[]];this.copyToClipboard(t.join(", "),e)}}}document.addEventListener("alpine:init",()=>{Alpine.data("aiGeneratorPage",l)});function d(){return{showConfirmModal:!1,competitorToDelete:null,competitors:[],query:"",suggestions:[],loading:!1,showSuggestions:!1,activeIndex:-1,selectedChannelTitle:"",isAdding:!1,limit:-1,formError:"",showIdeaModal:!1,isGeneratingIdeas:!1,ideaSourceTitle:"",generatedIdeas:[],showAnalysisModal:!1,analysisLoading:!1,currentAnalysis:null,analysisError:"",videoForAnalysis:null,init(){this.competitors=JSON.parse(document.getElementById("competitors-data").textContent),this.limit=COMPETITOR_LIMIT,this.$watch("query",e=>{this.formError="",e!==this.selectedChannelTitle&&(this.$refs.hiddenIdInput&&(this.$refs.hiddenIdInput.value=""),this.selectedChannelTitle="")}),this.$el.addEventListener("confirm-delete",e=>this.confirmDelete(e.detail)),this.$el.addEventListener("move-competitor",e=>this.moveCompetitor(e.detail.id,e.detail.direction)),this.$el.addEventListener("go-to-analysis",e=>this.goToDeepAnalysis(e.detail.data,e.detail.competitor)),this.$el.addEventListener("analyze-transcript",e=>this.analyzeTranscript(e.detail.video))},get currentCount(){return this.competitors.length},get limitReached(){return this.limit!==-1&&this.currentCount>=this.limit},async handleAddCompetitor(){if(this.formError="",!this.$refs.hiddenIdInput.value){this.suggestions.length===1&&this.query.toLowerCase()===this.suggestions[0].title.toLowerCase()?(this.selectSuggestion(this.suggestions[0]),setTimeout(()=>this.handleAddCompetitor(),100)):this.formError="Please type and select a channel from the suggestion list.";return}if(this.isAdding)return;this.isAdding=!0;let e=this.$refs.addCompetitorForm,t={channel_url:this.query,channel_id_hidden:this.$refs.hiddenIdInput.value};try{let i=await fetch(e.action,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":e.querySelector("input[name=csrf_token]").value},body:JSON.stringify(t)}),s=await i.json();if(!i.ok)throw new Error(s.error||"An unknown error occurred.");s.success&&s.competitor&&(this.competitors.unshift(s.competitor),this.query="",this.$refs.hiddenIdInput&&(this.$refs.hiddenIdInput.value=""),this.suggestions=[])}catch(i){console.error("Error adding competitor:",i.message),this.formError=i.message}finally{this.isAdding=!1}},fetchSuggestions(){if(this.query.length<2){this.suggestions=[],this.showSuggestions=!1;return}this.loading=!0,this.showSuggestions=!0,fetch(`/api/search-channels?q=${this.query}`).then(e=>e.json()).then(e=>{this.suggestions=e,this.activeIndex=-1}).finally(()=>this.loading=!1)},selectSuggestion(e){this.query=e.title,this.selectedChannelTitle=e.title,this.$refs.hiddenIdInput.value=e.channel_id,this.showSuggestions=!1,this.activeIndex=-1},handleKeydown(e){!this.showSuggestions||this.suggestions.length===0||(e.key==="ArrowDown"?(e.preventDefault(),this.activeIndex=(this.activeIndex+1)%this.suggestions.length):e.key==="ArrowUp"?(e.preventDefault(),this.activeIndex=(this.activeIndex-1+this.suggestions.length)%this.suggestions.length):e.key==="Enter"&&(e.preventDefault(),this.activeIndex!==-1?this.selectSuggestion(this.suggestions[this.activeIndex]):this.handleAddCompetitor()))},confirmDelete(e){this.competitorToDelete=e,this.showConfirmModal=!0},proceedWithDelete(){this.competitorToDelete&&document.getElementById(`delete-form-${this.competitorToDelete}`).submit(),this.showConfirmModal=!1},moveCompetitor(e,t){let i=this.competitors.findIndex(o=>o.id===e);if(i===-1)return;let s=t==="up"?i-1:i+1;if(s<0||s>=this.competitors.length)return;[this.competitors[i],this.competitors[s]]=[this.competitors[s],this.competitors[i]];let a=document.querySelector('form[id="add-competitor-form"] input[name=csrf_token]').value;fetch(`/competitors/move/${e}/${t}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":a}}).then(o=>o.json()).then(o=>{o.success||([this.competitors[i],this.competitors[s]]=[this.competitors[s],this.competitors[i]],alert("Could not update position. Please refresh."))})},goToDeepAnalysis(e,t){sessionStorage.setItem("deepAnalysisPreload",JSON.stringify(e)),window.location.href=`/deep-analysis/${t.channel_id_youtube}`},analyzeTranscript(e){this.videoForAnalysis=e,this.showAnalysisModal=!0,this.analysisLoading=!0,this.currentAnalysis=null,this.analysisError="";let t=document.querySelector('form[id="add-competitor-form"] input[name=csrf_token]').value;fetch(`/api/competitor/analyze-transcript/${e.id}`,{method:"POST",headers:{"X-CSRFToken":t}}).then(i=>i.json()).then(i=>{i.error?(this.analysisError=i.error,this.currentAnalysis=null):(this.currentAnalysis={summary:i.summary||"Summary not available.",keywords:i.keywords||[],content_gaps:i.content_gaps||[]},this.analysisError="")}).catch(()=>{this.analysisError="An unexpected network error occurred.",this.currentAnalysis=null}).finally(()=>{this.analysisLoading=!1})},closeAnalysisModal(){this.showAnalysisModal=!1,this.videoForAnalysis=null,this.currentAnalysis=null,this.analysisError=""}}}function h(e){return{isLoading:!0,isRefreshing:!1,isRefreshed:!1,error:null,data:null,activeSort:"date",activeFilter:"all",allVideos:[],retryTimeout:null,ideaGenerationStatus:{},init(){let t=sessionStorage.getItem("deepAnalysisPreload");if(t)try{let i=JSON.parse(t);if(i&&i.details&&i.details.id===e.channel_id_youtube){this.data=i,this.processVideoSets(),this.isLoading=!1,this.error=null,sessionStorage.removeItem("deepAnalysisPreload");return}else sessionStorage.removeItem("deepAnalysisPreload")}catch{sessionStorage.removeItem("deepAnalysisPreload")}setTimeout(()=>this.fetchData(10),500)},fetchData(t=0){this.retryTimeout&&clearTimeout(this.retryTimeout),this.isLoading=!0,fetch(`/api/competitor/${e.id}/data`).then(i=>i.json()).then(i=>{(i.error||!i.details)&&t>0?this.retryTimeout=setTimeout(()=>this.fetchData(t-1),5e3):i.error?(this.error=i.error,this.isLoading=!1):(this.data=i,this.processVideoSets(),this.isLoading=!1,this.error=null)}).catch(()=>{t>0?this.retryTimeout=setTimeout(()=>this.fetchData(t-1),5e3):(this.error="Failed to load data after multiple attempts.",this.isLoading=!1)})},refreshData(){this.isRefreshing=!0,this.isRefreshed=!1;let t=document.querySelector('form[id="add-competitor-form"] input[name=csrf_token]').value;fetch(`/api/competitor/${e.id}/refresh`,{method:"POST",headers:{"X-CSRFToken":t}}).then(i=>i.json()).then(i=>{i.error?this.error=i.error:(this.data=i,this.processVideoSets(),this.isRefreshed=!0)}).catch(()=>this.error="Failed to refresh data.").finally(()=>this.isRefreshing=!1)},processVideoSets(){let t=this.data.recent_videos_data.videos||[],i=this.data.most_viewed_videos_data.videos||[],s={};[...t,...i].forEach(a=>{a&&a.id&&(s[a.id]=a)}),this.allVideos=Object.values(s).filter(Boolean)},get displayedVideos(){let t=[...this.allVideos];return this.activeFilter==="shorts"?t=t.filter(i=>i.is_short):this.activeFilter==="videos"&&(t=t.filter(i=>!i.is_short)),this.activeSort==="date"?t.sort((i,s)=>new Date(s.upload_date)-new Date(i.upload_date)):this.activeSort==="viewCount"?t.sort((i,s)=>s.view_count-i.view_count):this.activeSort==="most_comments"&&t.sort((i,s)=>s.comment_count-i.comment_count),t.slice(0,5)},addIdeaToPlanner(t){this.ideaGenerationStatus[t.id]="loading";let i=document.querySelector('form[id="add-competitor-form"] input[name=csrf_token]').value;fetch("/api/competitor/add-idea-from-video",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":i},body:JSON.stringify({title:t.title})}).then(s=>s.json()).then(s=>{s.success?this.ideaGenerationStatus[t.id]="success":(this.ideaGenerationStatus[t.id]="error",alert(s.error||"Failed to add idea."))}).catch(()=>{this.ideaGenerationStatus[t.id]="error",alert("An unexpected error occurred.")})}}}document.addEventListener("alpine:init",()=>{Alpine.data("competitorPage",d),Alpine.data("competitorCard",h)});function c(){return{isLoading:!0,error:null,data:{kpis:{},growth_chart:{labels:[],subscribers:[],views:[]},ai_assistant:[],top_recent_videos:[],goal:null,best_time_to_post:null,layout:null},chart:null,activeChartMetric:"subscribers",showGoalModal:!1,goalError:"",newGoal:{type:"subscribers",target:null,date:""},csrfToken:null,isSavingLayout:!1,saveStatus:"",showResetConfirmModal:!1,init(){let e=document.querySelector('input[name="csrf_token"]');e?this.csrfToken=e.value:console.error("CSRF Token input field not found!"),this.fetchData()},fetchData(){this.isLoading=!0,fetch(`/api/dashboard/main-data?t=${new Date().getTime()}`).then(e=>e.json()).then(e=>{this.data=e,this.error=null,this.$nextTick(()=>{this.applyLayout(),this.renderChart(),this.initSortable()})}).catch(e=>{this.error=e.message}).finally(()=>{this.isLoading=!1})},initSortable(){let e=document.getElementById("sortable-left"),t=document.getElementById("sortable-right"),i={group:"dashboard-cards",animation:150,handle:".drag-handle",onEnd:()=>this.saveLayout()};e&&!e.classList.contains("sortable-initialized")&&(new Sortable(e,i),e.classList.add("sortable-initialized")),t&&!t.classList.contains("sortable-initialized")&&(new Sortable(t,i),t.classList.add("sortable-initialized"))},applyLayout(){if(!this.data.layout||!this.data.layout.left||!this.data.layout.right)return;let e=document.getElementById("sortable-left"),t=document.getElementById("sortable-right");if(!e||!t)return;let i={};document.querySelectorAll("#sortable-left > [data-id], #sortable-right > [data-id]").forEach(s=>{i[s.dataset.id]=s}),this.data.layout.left.forEach(s=>{i[s]&&e.appendChild(i[s])}),this.data.layout.right.forEach(s=>{i[s]&&t.appendChild(i[s])})},async saveLayout(){this.isSavingLayout=!0,this.saveStatus="Saving...";let e=Array.from(document.getElementById("sortable-left").children).map(s=>s.dataset.id),t=Array.from(document.getElementById("sortable-right").children).map(s=>s.dataset.id),i={left:e,right:t};if(!this.csrfToken){console.error("CSRF Token not found! Cannot save layout."),this.saveStatus="Error!",this.isSavingLayout=!1;return}try{let s=await fetch("/api/dashboard/save-layout",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify(i)});if(!s.ok)throw new Error("Server responded with an error.");let a=await s.json();if(a.success)this.saveStatus="Saved!";else throw new Error(a.error||"Failed to save.")}catch(s){this.saveStatus="Error!",console.error("Failed to save layout:",s)}finally{this.isSavingLayout=!1,setTimeout(()=>{this.saveStatus=""},2e3)}},resetLayout(){this.showResetConfirmModal=!0},cancelReset(){this.showResetConfirmModal=!1},proceedWithReset(){this.showResetConfirmModal=!1;let e={left:["kpis","growth_chart","top_videos"],right:["goal","best_time","ai_assistant"]};this.data.layout=e,this.applyLayout(),this.saveLayout()},renderChart(){if(this.chart&&this.chart.destroy(),!this.$refs.growthChart||!this.data.growth_chart||!this.data.growth_chart.labels)return;let i=getComputedStyle(document.documentElement).getPropertyValue("--primary").trim().replace(/ /g,","),s=this.$refs.growthChart.getContext("2d"),a=s.createLinearGradient(0,0,0,250);a.addColorStop(0,`hsla(${i}, 0.5)`),a.addColorStop(1,`hsla(${i}, 0)`);let o=localStorage.getItem("theme")||"light",r=o==="dark"?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",n=o==="dark"?"#cbd5e1":"#475569";this.chart=new Chart(s,{type:"line",data:{labels:this.data.growth_chart.labels,datasets:[{label:this.activeChartMetric.charAt(0).toUpperCase()+this.activeChartMetric.slice(1),data:this.data.growth_chart[this.activeChartMetric],borderColor:`hsl(${i})`,backgroundColor:a,borderWidth:2,pointBackgroundColor:`hsl(${i})`,fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!1,grid:{color:r},ticks:{color:n}},x:{grid:{display:!1},ticks:{color:n}}},plugins:{legend:{display:!1},tooltip:{backgroundColor:"hsl(var(--card))",titleColor:"hsl(var(--foreground))",bodyColor:"hsl(var(--foreground))",borderColor:"hsl(var(--border))",borderWidth:1}}}})},updateChart(e){this.activeChartMetric=e,this.renderChart()},getIconForSuggestion(e){switch(e){case"topic":return"fa-solid fa-lightbulb text-yellow-500";case"performance":return"fa-solid fa-arrow-trend-up text-green-500";case"consistency":return"fa-solid fa-calendar-days text-blue-500";default:return"fa-solid fa-star text-primary"}},openGoalModal(){this.goalError="",this.newGoal={type:"subscribers",target:null,date:""},this.showGoalModal=!0},async saveGoal(){if(this.goalError="",!this.newGoal.target||this.newGoal.target<=0){this.goalError="Please enter a valid target value.";return}try{let e={"Content-Type":"application/json"};if(this.csrfToken)e["X-CSRFToken"]=this.csrfToken;else{console.error("Cannot save goal: CSRF Token is missing."),this.goalError="Security token missing. Please refresh the page.";return}let t=await fetch("/api/goals/",{method:"POST",headers:e,body:JSON.stringify({goal_type:this.newGoal.type,target_value:this.newGoal.target,target_date:this.newGoal.date||null})});if(!t.ok){let i=await t.json();throw new Error(i.error||"Failed to save goal.")}this.showGoalModal=!1,this.fetchData()}catch(e){this.goalError=e.message}}}}document.addEventListener("alpine:init",()=>{Alpine.data("dashboard",c)});function u(){return{videos:[],filter:"all",sortBy:"newest",selectedVideos:[],showBulkEditModal:!1,showConfirmModal:!1,bulkEditData:{tags_to_add:"",tags_to_remove:"",description_append:"",privacy_status:""},isBulkUpdating:!1,disclaimerChecked:!1,bulkEditMode:!1,userPlan:"free",dailyLimit:0,editsUsedToday:0,remainingEdits:0,limitMessage:"",isIndeterminate:!1,init(){typeof PAGE_DATA<"u"?(this.videos=PAGE_DATA.videos||[],this.dailyLimit=parseInt(PAGE_DATA.dailyLimit),(isNaN(this.dailyLimit)||this.dailyLimit<0&&this.dailyLimit!==-1)&&(console.warn("Invalid dailyLimit received, defaulting to 0."),this.dailyLimit=0),this.dailyLimit===-1&&(this.dailyLimit=1/0),this.editsUsedToday=parseInt(PAGE_DATA.editsUsedToday)||0,this.userPlan=PAGE_DATA.userPlan||"free"):(console.error("PAGE_DATA is not defined. Bulk edit limits and video list might not work correctly."),this.videos=[],this.dailyLimit=0),this.calculateRemaining(),this.checkSelectionLimit(),this.$watch("selectedVideos",()=>{this.calculateRemainingBasedOnSelection(),this.updateIndeterminateState()}),this.$watch("bulkEditMode",e=>{e?this.calculateRemaining():(this.limitMessage="",this.isIndeterminate=!1)})},calculateRemaining(){this.dailyLimit===1/0?this.remainingEdits=1/0:this.remainingEdits=Math.max(0,this.dailyLimit-this.editsUsedToday)},calculateRemainingBasedOnSelection(){this.dailyLimit===1/0?this.remainingEdits=1/0:this.remainingEdits=Math.max(0,this.dailyLimit-this.editsUsedToday)},getLimitMessage(){if(this.dailyLimit===1/0)return"";let e=this.dailyLimit;return`You can select ${Math.max(0,this.dailyLimit-this.editsUsedToday)} more videos today (${this.editsUsedToday}/${e} used for ${this.userPlan.charAt(0).toUpperCase()+this.userPlan.slice(1)} plan).`},checkSelectionLimit(){let e=this.selectedVideos.length,t=this.dailyLimit===1/0?1/0:Math.max(0,this.dailyLimit-this.editsUsedToday);this.updateIndeterminateState()},updateIndeterminateState(){let e=this.filteredAndSortedVideos.map(a=>a.id),t=e.filter(a=>this.selectedVideos.includes(a)).length;if(e.length===0||!this.bulkEditMode){this.isIndeterminate=!1;return}let i=this.dailyLimit===1/0?1/0:Math.max(0,this.dailyLimit-this.editsUsedToday-this.selectedVideos.length+t),s=Math.min(e.length,t+i);t===0?this.isIndeterminate=!1:t>=s&&e.length===s?this.isIndeterminate=!1:t>0&&t<e.length?this.isIndeterminate=!0:this.isIndeterminate=!1},get isAllSelected(){let e=this.filteredAndSortedVideos.map(a=>a.id);if(e.length===0||!this.bulkEditMode)return!1;let t=this.dailyLimit===1/0?1/0:Math.max(0,this.dailyLimit-this.editsUsedToday-(this.selectedVideos.length-e.filter(a=>this.selectedVideos.includes(a)).length)),i=Math.min(e.length,t+e.filter(a=>this.selectedVideos.includes(a)).length);return e.filter(a=>this.selectedVideos.includes(a)).length>=i&&i>0},get filteredAndSortedVideos(){if(!Array.isArray(this.videos))return console.error("this.videos is not an array:",this.videos),[];let e=[...this.videos];return this.filter==="shorts"?e=e.filter(t=>t.is_short):this.filter==="videos"&&(e=e.filter(t=>!t.is_short)),this.sortBy==="newest"?e.sort((t,i)=>{let s=t.published_at?new Date(t.published_at):0;return(i.published_at?new Date(i.published_at):0)-s}):this.sortBy==="views"&&e.sort((t,i)=>(i.view_count||0)-(t.view_count||0)),e},toggleBulkEditMode(){this.bulkEditMode=!this.bulkEditMode,this.bulkEditMode||(this.selectedVideos=[]),this.limitMessage="",this.isIndeterminate=!1,this.calculateRemaining()},toggleSelectAll(e){if(!this.bulkEditMode)return;let t=this.filteredAndSortedVideos.map(a=>a.id),i=this.selectedVideos.filter(a=>!t.includes(a)),s=t.filter(a=>this.selectedVideos.includes(a));if(e.target.checked){let a=this.dailyLimit===1/0?1/0:Math.max(0,this.dailyLimit-this.editsUsedToday-i.length),o=t.filter(r=>!this.selectedVideos.includes(r)).slice(0,a);this.selectedVideos=[...i,...s,...o],o.length<t.length-s.length?(this.limitMessage=`Selected ${o.length} more videos due to daily limit.`,setTimeout(()=>this.limitMessage="",3e3),e.target.checked=!1,this.isIndeterminate=this.selectedVideos.length>0):(this.limitMessage="",this.isIndeterminate=!1)}else this.selectedVideos=i,this.limitMessage="",this.isIndeterminate=!1;this.calculateRemaining(),this.updateIndeterminateState()},handleCardClick(e){if(this.bulkEditMode){let t=this.selectedVideos.indexOf(e);if(t>-1)this.selectedVideos.splice(t,1),this.limitMessage="";else if((this.dailyLimit===1/0?1:Math.max(0,this.dailyLimit-this.editsUsedToday-this.selectedVideos.length))<=0){this.calculateRemaining(),this.limitMessage=this.getLimitMessage(),setTimeout(()=>this.limitMessage="",3e3);return}else this.selectedVideos.push(e),this.limitMessage="";this.calculateRemainingBasedOnSelection(),this.updateIndeterminateState()}},openBulkEditModal(){this.bulkEditData={tags_to_add:"",tags_to_remove:"",description_append:"",privacy_status:""},this.disclaimerChecked=!1,this.showBulkEditModal=!0},submitBulkEdit(){if(this.selectedVideos.length===0){alert("Please select at least one video.");return}if(!this.disclaimerChecked){alert("Please read and acknowledge the disclaimer by checking the box before proceeding.");return}let e=this.dailyLimit===1/0?1/0:Math.max(0,this.dailyLimit-this.editsUsedToday);if(this.selectedVideos.length>e){alert(`You have selected ${this.selectedVideos.length} videos, but you can only edit ${e} more today based on your plan limit.`);return}this.showConfirmModal=!0},async proceedWithBulkEdit(){this.showConfirmModal=!1,this.isBulkUpdating=!0;let e={video_ids:this.selectedVideos,operations:this.bulkEditData},t=0,i=null,s=this.editsUsedToday;try{let a=document.querySelector('input[name="csrf_token"]').value,o=await fetch("/manage/videos/bulk-edit",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":a},body:JSON.stringify(e)});if(t=o.status,i=await o.json(),!o.ok)throw new Error(i.error||`Server error: ${o.status}`);alert(i.message),window.location.reload()}catch(a){t===429?(alert("Error: "+(i.error||"Daily bulk edit limit exceeded.")),this.disclaimerChecked=!1):(alert("Error: "+a.message),this.showBulkEditModal=!1)}finally{t>=200&&t<300||(this.isBulkUpdating=!1),t===429&&(this.isBulkUpdating=!1)}},formatRelativeTime(e){if(!e)return"";try{let t=new Date(e),s=new Date().getTime()-t.getTime(),a=Math.round(s/1e3);if(a<60)return"just now";let o=Math.floor(a/60);if(o<60)return`${o}m ago`;let r=Math.floor(o/60);if(r<24)return`${r}h ago`;let n=Math.floor(r/24);return n<7?`${n}d ago`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch(t){return console.error("Error formatting date:",e,t),"Invalid Date"}}}}document.addEventListener("alpine:init",()=>{Alpine.data("videoManager",u)});})();
